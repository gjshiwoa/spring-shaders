# AGENTS.md

This file provides guidance to agents when working with code in this repository.

## 项目调试规则（非显而易见部分）

### 着色器编译错误排查
- 编译错误日志位于 `.minecraft/logs/latest.log`，使用错误行号定位问题
- 检查所有 `#include` 路径是否正确，特别是相对路径（以 `/` 开头）
- 验证所有 `#ifdef` 条件编译块是否正确配对
- 确认所有纹理格式声明与 `shaders.properties` 中的定义一致

### 视觉伪影诊断
- NaN 值通常由除以零或未初始化变量引起，使用 `isnan()` 检查
- 光晕效应检查深度测试和法线计算
- 色带问题检查精度损失（使用 `mediump` 而非 `lowp`）
- 时间重影检查时间重投影缓冲区是否正确清除

### 性能分析技巧
- 使用简单着色器替换复杂效果来定位性能瓶颈
- 检查循环中的样本数是否合理（特别是光线行进算法）
- 验证分支预测是否有效（减少动态分支）
- 监控纹理带宽使用（大格式纹理如 RGBA16F）

### 特定模块调试
- 水面渲染：检查法线贴图和波浪参数
- 大气散射：验证散射常数和采样密度
- 阴影映射：检查偏置值和过滤样本数
- 植物动画：验证时间函数和振幅参数

### 维度特定问题
- 下界渲染：检查雾效果和光照模型
- 末地渲染：验证特殊天空盒和颜色处理
- 主世界：检查日夜循环和天气效果

### 交叉兼容性检查
- 确保在 Iris 和 OptiFine 下都能正常工作
- 验证不同 Minecraft 版本的兼容性（检查 MC_VERSION 宏）
- 测试不同显卡驱动的兼容性（特别是 Intel 集成显卡）